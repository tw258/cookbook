<div class="header-grid">
  <button routerLink="" mat-icon-button>
    <mat-icon>arrow_back_ios</mat-icon>
  </button>
  <h1>Neues Rezept</h1>
</div>

<form class="mt-1">
  <mat-form-field appearance="outline">
    <mat-label>Rezeptname</mat-label>
    <input
      [(ngModel)]="recipe.title"
      [ngModelOptions]="{ standalone: true }"
      matInput
      placeholder="z.B. Spaghetti Bolognese"
    />
  </mat-form-field>

  <div class="images-container mt-1">
    <img
      src="https://img.chefkoch-cdn.de/rezepte/1121671218451489/bilder/1378567/crop-600x400/pizza-salami-mit-knoblauch.jpg"
      alt=""
    />
    <app-add-image (imageUpload)="handleImageAdd($event)"></app-add-image>
  </div>

  <section class="mt-1">
    <h3>Zutaten</h3>

    <div class="ingredient-container">
      <mat-form-field appearance="outline">
        <mat-label>Menge</mat-label>
        <input
          [(ngModel)]="currentParameterizedIngredient.amount"
          [ngModelOptions]="{ standalone: true }"
          P
          type="number"
          min="0"
          matInput
          placeholder="0,1,..."
          value="1"
        />
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Einheit</mat-label>
        <mat-select
          [(ngModel)]="currentParameterizedIngredient.measurement"
          [ngModelOptions]="{ standalone: true }"
          value="Stck"
        >
          <mat-option value="g">g</mat-option>
          <mat-option value="kg">kg</mat-option>
          <mat-option value="ml">ml</mat-option>
          <mat-option value="l">l</mat-option>
          <mat-option value="TL">TL</mat-option>
          <mat-option value="EL">EL</mat-option>
          <mat-option value="Prise">Prise</mat-option>
          <mat-option value="Stck">Stck</mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Zutat</mat-label>
        <input
          [(ngModel)]="currentParameterizedIngredient.ingredient"
          [ngModelOptions]="{ standalone: true }"
          matInput
          placeholder="Eier, Mehl, ..."
        />
      </mat-form-field>

      <button
        type="button"
        [disabled]="
          !currentParameterizedIngredient.amount ||
          !currentParameterizedIngredient.ingredient ||
          !currentParameterizedIngredient.measurement
        "
        mat-icon-button
        (click)="handleAddIngredient()"
      >
        <span class="material-icons-outlined"> add_circle_outline </span>
      </button>
    </div>
    <mat-list role="list">
      <mat-list-item
        class="ingredient-list-item"
        role="listitem"
        *ngFor="let paramIngr of recipe.parameterizedIngredients"
      >
        <div class="ingredient-box">
          <span>{{ paramIngr.amount }} {{ paramIngr.measurement }} {{ paramIngr.ingredient }}</span>
          <button mat-icon-button type="button" (click)="handleRemoveIngredient(paramIngr)">
            <span class="material-icons-outlined"> clear </span>
          </button>
        </div>
      </mat-list-item>
    </mat-list>
  </section>

  <mat-form-field class="mt-1" appearance="outline">
    <mat-label>Zubereitung</mat-label>
    <textarea
      [(ngModel)]="recipe.note"
      [ngModelOptions]="{ standalone: true }"
      class="zubereitung"
      matInput
      placeholder="1. ...  2. ..."
    ></textarea>
  </mat-form-field>

  <div class="mt-1">
    <mat-label class="mat-small">Anspruch</mat-label>
    <mat-button-toggle-group
      [(ngModel)]="recipe.difficulty"
      [ngModelOptions]="{ standalone: true }"
      class="difficulty-box"
      name="fontStyle"
    >
      <mat-button-toggle value="Einfach">Einfach</mat-button-toggle>
      <mat-button-toggle value="Mittel">Mittel</mat-button-toggle>
      <mat-button-toggle value="Schwer">Schwer</mat-button-toggle>
    </mat-button-toggle-group>
  </div>

  <div class="mt-1 preparationtime-box">
    <div>
      <span class="mat-small">Zubereitungszeit: </span>
      <span class="mat-small"
        ><strong>{{ recipe.preparationTimeInMinutes }} Min</strong></span
      >
    </div>

    <div style="display: grid; grid-template-columns: 1fr auto; align-items: center">
      <mat-slider
        [(ngModel)]="recipe.preparationTimeInMinutes"
        [ngModelOptions]="{ standalone: true }"
        step="5"
        min="0"
        tickInterval="1"
        [max]="maxTime"
        color="primary"
      ></mat-slider>
      <button (click)="maxTime = maxTime + 30" mat-icon-button>
        <mat-icon>more_time</mat-icon>
      </button>
    </div>
  </div>

  <div class="btn-grid mt-1">
    <button
      [disabled]="!recipe.title || !recipe.note || !recipe.difficulty"
      (click)="handleSave()"
      type="button"
      mat-raised-button
      color="primary"
    >
      Speichern
    </button>
  </div>
</form>
